<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);
  
      function drawChart() {
        fetch('/sensor/list', {mode: 'cors'}).then(function(res) {
	       return res.json();
        }).then(function(sensorjson) {
		sensorjson.forEach(function (sensor) {
		fetch('/temp/'+sensor+'/list', {mode: 'cors'}).then(function(res) {
	         return res.json();
          }).then(function(json) {
    	  var arraydata = [['Time', sensor]];
		  json.forEach(function (element)  {
		  		arraydata.push([new Date(element.utc_timestamp), element.tempInFarenheit]);
		  });
		  var data = google.visualization.arrayToDataTable(arraydata);
		
          var options = {
            title: 'Temperatures',
            curveType: 'function',
            legend: { position: 'bottom' }
          };

		  var chartdiv = document.createElement("div");
			chartdiv.style="width: 900px; height: 500px";
          document.body.appendChild(chartdiv);			
          var chart = new google.visualization.LineChart(chartdiv);

          chart.draw(data, options);
		  });
		});
		});
      }
	  
    </script>
  </head>
  <body>
  </body>
</html>

